# AI Tab Clear - 新功能说明

# AI Tab Clear - 新功能说明

## 🆕 v1.1.0 更新

### 1. 智能重复域名清理

**功能说明**：
当同一域名（如 `github.com`）打开超过 3 个标签页时，扩展会自动关闭该域名下最旧的标签页，只保留最近活动的 2 个。

**特点**：
- **智能判断**：基于域名分组，不影响其他网站
- **时间优先**：总是保留最近活动的标签页
- **白名单优先**：白名单中的域名即使超过数量也不会被关闭
- **默认开启**：可以在设置中随时关闭此功能

**使用场景**：
- 防止打开过多重复的文档或搜索结果
- 保持工作区整洁
- 自动清理积压的同类页面

### 2. 原生标签页自动清理

**功能说明**：
自动识别并关闭闲置的 Chrome 原生标签页（如 `chrome://newtab`, `chrome://settings` 等）。

**特点**：
- **独立控制**：不受"最小标签页数量"限制，只要闲置超时即关闭
- **独立计时**：可单独设置原生标签页的闲置时间
- **默认开启**：安装后默认启用，保持浏览器整洁

### 3. 固定标签页保护

**功能说明**：
自动识别浏览器中"固定"（Pinned）的标签页，并将其排除在自动关闭规则之外。

**特点**：
- **默认保护**：固定标签页通常是常用工具（如邮箱、日历），默认不关闭
- **可配置**：如果需要，也可以在设置中关闭此保护，允许自动关闭固定标签页

### 4. 全新现代化 UI

**设计改进**：
- **极简主义**：移除多余边框和装饰，强调内容
- **精致排版**：优化字体大小和间距，提升可读性
- **流畅动画**：更自然的过渡效果和交互反馈
- **沉浸体验**：重新设计的深色/浅色主题，更具质感

---

## 🆕 v1.0.0 功能

### 1. 标签页数量阈值控制

**功能说明**：
只有当打开的标签页总数超过设定的阈值时，扩展才会开始自动关闭闲置标签页。

**使用场景**：
- 防止在标签页较少时误关闭重要页面
- 只在标签页过多时才进行清理
- 更智能的标签页管理策略

**如何使用**：
1. 打开扩展弹窗
2. 切换到"设置"标签页
3. 找到"最小标签页数量"设置项
4. 输入阈值（默认：10，范围：1-999）
5. 点击"保存设置"

**示例**：
- 设置为 10：只有当打开超过 10 个标签页时才开始自动关闭
- 设置为 20：只有当打开超过 20 个标签页时才开始自动关闭
- 设置为 5：只有当打开超过 5 个标签页时才开始自动关闭

---

### 2. 日间/夜间主题切换

**功能说明**：
支持在日间模式和夜间模式之间一键切换，适应不同的使用环境和个人偏好。

**主题特点**：

**夜间模式（默认）**：
- 深色背景 (#0f172a, #1e293b)
- 柔和的文字颜色
- 适合低光环境
- 减少眼睛疲劳

**日间模式**：
- 浅色背景 (#f8fafc, #f1f5f9)
- 清晰的文字对比
- 适合明亮环境
- 清新简洁

**如何使用**：
1. 打开扩展弹窗
2. 点击右上角的主题切换按钮
   - 🌙 = 夜间模式（深色）
   - ☀️ = 日间模式（浅色）
3. 主题偏好会自动保存

**特性**：
- 即时切换，无需刷新
- 主题偏好持久化保存
- 流畅的过渡动画
- 所有 UI 元素自动适配

---

## 📊 完整功能列表

### 核心功能
1. ✅ 自动关闭闲置标签页
2. ✅ 标签页数量阈值控制 ⭐ 新增
3. ✅ 白名单/黑名单正则匹配
4. ✅ 历史记录和一键恢复
5. ✅ 暂停/继续功能
6. ✅ 防重复记录

### UI/UX 功能
1. ✅ 日间/夜间主题切换 ⭐ 新增
2. ✅ 现代化设计
3. ✅ 玻璃态效果
4. ✅ 流畅动画
5. ✅ 响应式布局

---

## 🔧 技术实现

### 标签页数量阈值

**后台逻辑 (background.js)**：
```javascript
// 默认设置中添加 minTabCount
const DEFAULT_SETTINGS = {
  idleTime: 30,
  minTabCount: 10, // 新增
  whitelist: [],
  blacklist: [],
  isPaused: false
};

// 检查时先判断标签页数量
const tabs = await chrome.tabs.query({});
if (tabs.length <= currentSettings.minTabCount) {
  console.log('Tab count below threshold, skipping');
  return;
}
```

**前端表单 (popup.html/js)**：
- 添加数字输入框
- 验证输入范围（1-999）
- 保存到 chrome.storage

### 主题切换

**CSS 变量系统 (popup.css)**：
```css
:root {
  /* 夜间模式变量 */
  --bg-primary: #0f172a;
  --text-primary: #f1f5f9;
}

body.light-theme {
  /* 日间模式变量 */
  --bg-primary: #f8fafc;
  --text-primary: #0f172a;
}
```

**JavaScript 逻辑 (popup.js)**：
```javascript
// 主题切换
themeBtn.addEventListener('click', async () => {
  const { theme } = await chrome.storage.local.get('theme');
  const newTheme = theme === 'light' ? 'dark' : 'light';
  await chrome.storage.local.set({ theme: newTheme });
  applyTheme(newTheme);
});

// 应用主题
function applyTheme(theme) {
  if (theme === 'light') {
    document.body.classList.add('light-theme');
    themeIcon.textContent = '☀️';
  } else {
    document.body.classList.remove('light-theme');
    themeIcon.textContent = '🌙';
  }
}
```

---

## 📝 更新日志

### v1.0.0 (2025-12-02)
- 🎉 首次发布
- ✨ 自动关闭闲置标签页
- ✨ 标签页数量阈值控制 ⭐ 新增
- ✨ 白名单/黑名单支持
- ✨ 历史记录功能
- ✨ 暂停/继续功能
- ✨ 日间/夜间主题切换 ⭐ 新增
- ✨ 现代化 UI 设计

---

## 🎯 使用建议

### 推荐配置

**日常使用**：
- 闲置时间：30-60 分钟
- 最小标签页数量：10-15 个
- 主题：根据环境光线选择

**工作场景**：
- 闲置时间：15-30 分钟
- 最小标签页数量：20-30 个
- 主题：日间模式

**轻度使用**：
- 闲置时间：60-120 分钟
- 最小标签页数量：5-10 个
- 主题：个人偏好

### 最佳实践

1. **合理设置阈值**：根据自己的使用习惯调整最小标签页数量
2. **善用白名单**：将常用网站加入白名单，避免误关闭
3. **定期查看历史**：通过历史记录了解自己的浏览习惯
4. **适时暂停**：在需要保留所有标签页时使用暂停功能
5. **选择合适主题**：根据环境光线选择舒适的主题

---

## 💡 提示

- 主题切换是即时的，可以随时调整
- 标签页数量阈值可以防止过度清理
- 所有设置都会自动保存，无需担心丢失
- 扩展在后台静默运行，不影响浏览器性能
