# AI Tab Clear - 完整使用手册

欢迎使用 **AI Tab Clear**！这是一款强大的 Chrome 浏览器扩展，旨在通过智能算法自动管理您的标签页，保持浏览器的整洁与高效。

## 📚 目录

1. [核心功能](#-核心功能)
2. [安装指南](#-安装指南)
3. [快速开始](#-快速开始)
4. [详细功能说明](#-详细功能说明)
    - [自动关闭策略](#自动关闭策略)
    - [智能分组 (AI & 本地)](#智能分组-ai--本地)
    - [历史记录与搜索](#历史记录与搜索)
    - [多语言支持](#多语言支持)
5. [配置指南](#-配置指南)
6. [常见问题 (FAQ)](#-常见问题-faq)
7. [开发者指南](#-开发者指南)

---

## 🌟 核心功能

- **智能自动关闭**：根据闲置时间、标签页数量阈值自动清理不活动的标签页。
- **AI 智能分类**：集成 Gemini/OpenAI/Grok 等 AI 模型，或使用高效的本地算法，对历史记录进行智能归类。
- **多语言支持**：内置 9 种语言（中、英、日、韩、德、法、西、意），一键切换。
- **现代化 UI**：精美的卡片式设计，支持深色模式 (Dark Mode) 和玻璃态特效。
- **历史记录管理**：强大的历史记录搜索、过滤和一键恢复功能。
- **灵活规则**：支持白名单（永不关闭）和黑名单（立即关闭）配置。

---

## 📥 安装指南

目前扩展处于开发/测试阶段，请通过"开发者模式"安装：

1. **下载代码**：下载本项目的 ZIP 包并解压，或使用 Git 克隆：
   ```bash
   git clone https://github.com/yang904839-blip/ai-tab-clear.git
   ```
2. **打开扩展管理**：在 Chrome 地址栏输入 `chrome://extensions/` 并回车。
3. **开启开发者模式**：点击右上角的开关启用"开发者模式"。
4. **加载扩展**：点击左上角的"加载已解压的扩展程序" (Load unpacked)。
5. **选择目录**：选择解压后的 `ai-tab-clear` 文件夹。
6. **完成**：现在您应该能在浏览器工具栏看到 AI Tab Clear 的图标了！

---

## 🚀 快速开始

1. **点击图标**：点击浏览器右上角的扩展图标打开界面。
2. **设置闲置时间**：在"设置"标签页，建议将"闲置时间"设置为 30 分钟。
3. **开启 AI (可选)**：如果您有 API Key，可以在"智能分组"中选择 "AI 智能" 并配置 Key；否则默认使用"本地算法"。
4. **开始浏览**：扩展将在后台默默工作。当标签页闲置超过设定时间且总数超过阈值时，它们会被自动关闭并归档到"历史"中。

---

## 📖 详细功能说明

### 自动关闭策略

扩展采用多重条件判断来决定是否关闭标签页：

1. **闲置时间检测**：标签页必须连续未被访问超过设定的分钟数。
2. **最小数量阈值**：只有当打开的标签页总数超过设定值（默认 10 个）时，才会触发清理。
3. **重复域名清理**：如果同一域名打开了超过 3 个标签页，较旧的闲置标签页会被优先关闭。
4. **原生标签页**：支持自动清理闲置的 `chrome://` 系统页面（如设置、下载页）。
5. **音频/表单保护**：正在播放音频或包含未提交表单的标签页通常不会被关闭（取决于浏览器行为）。

### 智能分组 (AI & 本地)

在"设置" -> "智能分组"中选择分组方式：

- **本地算法 (默认)**：
    - **特点**：速度极快，无需联网，无需 API Key。
    - **原理**：根据 URL 关键词和域名后缀进行规则匹配分类（如 `github.com` -> 开发，`youtube.com` -> 娱乐）。
- **AI 智能**：
    - **特点**：分类更精准，能理解网页标题含义。
    - **支持模型**：Google Gemini, OpenAI, xAI (Grok)。
    - **配置**：需要填写对应的 API Key。

**手动重新分组**：在"历史"页面顶部，点击"⚡️ 立即重新分组"按钮，可使用当前选定的算法对所有历史记录重新分类。

### 历史记录与搜索

- **查看历史**：点击"历史"标签页，查看所有已关闭的标签页。
- **折叠/展开**：历史记录按类别分组（如"开发"、"娱乐"），点击组标题可折叠或展开。
- **搜索过滤**：在顶部的搜索框输入关键词，实时过滤标题或 URL。
    - **高亮显示**：匹配的关键词会以黄色高亮显示。
    - **自动展开**：搜索时会自动展开包含匹配项的分组。
- **一键恢复**：点击任意历史条目即可在后台打开该标签页。
- **清空历史**：点击底部的"清空历史"按钮删除所有记录。

### 多语言支持

扩展支持 9 种语言，界面会自动适配。您也可以手动切换：

1. 在扩展顶栏左侧找到语言选择下拉框。
2. 选择您偏好的语言（如 `简体中文`、`English`、`日本語` 等）。
3. 界面会自动刷新并应用新语言。

---

## ⚙️ 配置指南

进入"设置"标签页进行详细配置：

| 设置项 | 说明 | 默认值 |
| :--- | :--- | :--- |
| **闲置时间** | 标签页不活动多少分钟后自动关闭 | 30 分钟 |
| **最少保留标签数** | 只有当标签页总数超过此值时才开始清理 | 10 个 |
| **清理重复域名** | 是否自动关闭同一域名的多余标签页（保留最近3个） | 开启 |
| **清理原生标签页** | 是否自动关闭闲置的 `chrome://` 页面 | 开启 |
| **原生标签闲置时间** | 原生标签页的独立闲置时间设置 | 30 分钟 |
| **保护固定标签页** | 是否永远不关闭已固定 (Pinned) 的标签页 | 开启 |
| **历史记录保留条数** | 历史记录中最多保存多少条数据 | 100 条 |
| **分组方式** | 选择 "本地算法" 或 "AI 智能" | 本地算法 |
| **白名单** | 输入正则表达式（每行一个），匹配的 URL **永不关闭** | (空) |
| **黑名单** | 输入正则表达式（每行一个），匹配的 URL **立即关闭** | (空) |

**白名单示例**：
```text
google\.com
github\.com
.*\.work\.com
```

---

## ❓ 常见问题 (FAQ)

**Q: 为什么我的标签页没有被关闭？**
A: 请检查：
1. 标签页数量是否未达到"最少保留标签数"。
2. 标签页是否在"白名单"中。
3. 标签页是否被固定（且开启了"保护固定标签页"）。
4. 扩展是否处于"暂停"状态（检查顶栏的暂停按钮）。

**Q: AI 分组不工作/报错？**
A: 请确保：
1. 已在设置中选择了"AI 智能"。
2. 已填写正确的 API Key。
3. 网络环境可以访问对应的 AI 服务接口。

**Q: 如何备份我的设置？**
A: 目前扩展使用 Chrome 本地存储，暂不支持导出配置文件。卸载扩展会丢失设置和历史记录。

---

## 👨‍💻 开发者指南

如果您想参与开发或修改代码：

- **技术栈**：原生 JavaScript (ES6+), HTML5, CSS3 (Variables, Flexbox)。
- **自动重载**：运行 `./reload.sh` (Mac/Linux) 或 `node watch.js`，修改代码后扩展会自动重新加载。
- **目录结构**：
    - `background.js`: 后台服务，处理自动关闭逻辑。
    - `popup.js`: 界面逻辑。
    - `_locales/`: 国际化语言文件。

更多详情请参阅 `GIT_GUIDE.md`。

---

**AI Tab Clear** - 让您的浏览器重获新生。
